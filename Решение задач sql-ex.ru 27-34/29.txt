
Фирма имеет несколько пунктов приема вторсырья. 
Каждый пункт получает деньги для их выдачи сдатчикам вторсырья. 
Сведения о получении денег на пунктах приема записываются в таблицу:
Income_o(point, date, inc)

Первичным ключом является (point, date). При этом в столбец date записывается только дата (без времени), 
т.е. прием денег (inc) на каждом пункте производится не чаще одного раза в день. Сведения о выдаче денег сдатчикам вторсырья записываются в таблицу:
Outcome_o(point, date, out)

В этой таблице также первичный ключ (point, date) гарантирует отчетность каждого пункта о выданных деньгах (out) не чаще одного раза в день.
В случае, когда приход и расход денег может фиксироваться несколько раз в день, 
используется другая схема с таблицами, имеющими первичный ключ code:

Income(code, point, date, inc)
Outcome(code, point, date, out)

Здесь также значения столбца date не содержат времени.



В предположении, что приход и расход денег на каждом пункте приема фиксируется не чаще одного раза в день [т.е. первичный ключ (пункт, дата)], 
написать запрос с выходными данными (пункт, дата, приход, расход). Использовать таблицы Income_o и Outcome_o. 









SELECT income_o.point, income_o.date, inc, out

FROM income_o 

LEFT JOIN outcome_o 

ON income_o.point = outcome_o.point

AND 
income_o.date = outcome_o.date

UNION

SELECT outcome_o.point, outcome_o.date, inc, out

FROM income_o 

RIGHT JOIN outcome_o 

ON income_o.point = outcome_o.point

AND 

income_o.date = outcome_o.date

